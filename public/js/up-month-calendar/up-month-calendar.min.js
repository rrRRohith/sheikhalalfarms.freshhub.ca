!function(o,t,s,e){var a=function(t,e){this.elem=t,this.$elem=o(t),this.options=e,this.currentDate=moment().format("YYYY-MM-DD"),this.currentDateObj=moment(this.currentDate,"YYYY-MM-DD"),this.today=this.currentDateObj.format("YYYY-MM-DD"),this.settings={dateFormat:"YYYY-MM-DD",addMonthFormat:"Month",monthNameFormat:"MMMM",yearNameFormat:"YYYY",getDaysArrayFormat:"YYYY-MM",dateDayFormat:"D",startOfMonth:"month",startOfWeek:"week"}};a.defaults=(a.prototype={defaults:{lang:"en",type:"gregorian",nextHtml:"",previousHtml:"",holidayURL:null,i18n:{recurring:"Recurring Holiday",holidayDesc:"Holiday Description",saveBtn:"Save",createError:"Error while saving!"}},init:function(){return this.config=o.extend({},this.defaults,this.options),this.setupOptions(),this.doRenderBasicHtml(),this.bindEvents(this,this.elem),this.doRenderMonthYearView(),this.doRenderWeekDaysName(),this.doRenderMonthDays(),this.holidayListAjax(this),this},setupOptions:function(){switch(this.config.lang){case"fa":moment.loadPersian({dialect:"persian-modern"})}switch(this.config.type){case"jalali":this.settings={dateFormat:"jYYYY-jMM-jDD",addMonthFormat:"jMonth",monthNameFormat:"jMMMM",yearNameFormat:"jYYYY",getDaysArrayFormat:"jYYYY-jMM",dateDayFormat:"jD",startOfMonth:"jMonth",startOfWeek:"week"},this.currentDate=moment().format(this.settings.dateFormat);break;default:this.currentDate=moment().format(this.settings.dateFormat)}this.currentDateObj=moment(this.currentDate,this.settings.dateFormat),this.today=this.currentDateObj.format(this.settings.dateFormat),this.currentDateInWeek=this.currentDateObj.format(this.settings.dateFormat)},preLoader:function(t,e,a){a=a||1;!0===e?1===a?(t.find("clr-icon").hide(),t.prepend('<div class="preloader"></div>'),t.prop("disabled",!0).addClass("disabled")):2===a&&t.prepend('<div class="preloader preloader-lg"></div>\n         <div class="preloader-backdrop"></div>'):1===a?(t.find("clr-icon").show(),t.find(".preloader").remove(),t.prop("disabled",!1).removeClass("disabled")):2===a&&(t.find(".preloader-backdrop").remove(),t.find(".preloader").remove())},getDateMonthName:function(){return this.currentDateObj.format(this.settings.monthNameFormat)},getDateYear:function(){return this.currentDateObj.format(this.settings.yearNameFormat)},getDateWeekDays:function(){var t=[],e=this.currentDateObj.clone();t.push(e.startOf("week").format("dd"));for(var a=0;a<6;a++)t.push(e.add(1,"day").format("dd"));return t},getCurrentDate:function(){return this.currentDateObj.clone()},getMonthDay:function(){var t=this.getCurrentDate(),e=Number(t.endOf(this.settings.startOfMonth).format(this.settings.dateDayFormat)),a=[];t.startOf(this.settings.startOfMonth),a.push(t.clone());for(var n=1;n<e;n++)t.add(1,"day"),a.push(t.clone());return a},getNextMonth:function(){return this.currentDateObj.add(1,this.settings.startOfMonth)},getPreviousMonth:function(){return this.currentDateObj.subtract(1,this.settings.startOfMonth)},getCurrentStartDate:function(){return this.currentDateObj.clone().startOf(this.settings.startOfMonth).format(this.settings.dateFormat)},getCurrentEndDate:function(){return this.currentDateObj.clone().endOf(this.settings.startOfMonth).format(this.settings.dateFormat)},getBasicHtml:function(){return'<div class="calendar-month">   <div class="calendar-month-top row mt-1">\n       <div class="col-lg-12">\n           <div class="calendar-arrows calendar-arrows-space-between">\n               <span class="number calendar-month-top-month-name"></span>\n               <div class="calendar-arrows-item">\n                   <a class="calendar-nav js-previous-month" href="#">\n                       <clr-icon shape="caret right"></clr-icon>\n                   </a>\n                   <a class="calendar-nav js-next-month" href="#">\n                       <clr-icon shape="caret left"></clr-icon>\n                   </a>\n               </div>\n           </div>\n       </div>\n   </div>\n   <div class="calendar-month-header">\n   </div>\n   <div class="calendar-month-days">\n   </div></div><div class="js-holiday-form mb-1" style="display: none;">    <input type="hidden" name="id">    <input type="hidden" name="date">    <div class="input-group">        <input name="description" class="form-control" placeholder="'+this.config.i18n.holidayDesc+'">        <div class="input-group-append">            <span class="input-group-text">                <a href="#" class="js-submit-desc-holiday text-gray-dark">'+this.config.i18n.saveBtn+"</a>            </span>        </div>    </div></div>"},bindEvents:function(i,r){o(s).on("click",".js-previous-month",function(t){t.preventDefault(),i.getPreviousMonth(),i.doRenderMonthYearView(),i.doRenderMonthDays(),i.holidayListAjax(i)}),o(s).on("click",".js-next-month",function(t){t.preventDefault(),i.getNextMonth(),i.doRenderMonthYearView(),i.doRenderMonthDays(),i.holidayListAjax(i)}),o(s).on("click",".calendar-month-day-num",function(t){t.preventDefault();var e=o(this),a=e.attr("data-date"),n=o(r).find(".js-holiday-form");e.hasClass("calendar-holiday-selected")?(e.removeClass("calendar-holiday-selected"),n.hide(),i.holidayDeleteAjax(e)):(e.addClass("calendar-holiday-selected"),n.find('[name="description"]').val(""),n.show(),i.holidayCreateAjax(a,e,n))}),o(s).on("click",".js-submit-desc-holiday",function(t){t.preventDefault();var e=o(this).closest(".js-holiday-form"),a=e.find('[name="id"]').val(),n=e.find('[name="description" ]').val(),r=e.find('[name="date" ]').val();e.hide(),i.holidayUpdateAjax(i.config.holidayURL,a,r,n)})},holidayUpdateAjax:function(t,e,a,n){o.ajax({url:this.config.holidayURL+"/"+e,type:"PUT",data:{date:a,description:n},success:function(t){""!==t.description&&o(s).find('[data-date="'+t.date+'"]').attr("rel","tooltip").attr("data-tooltip",t.description)},error:function(t){console.log(t)}})},holidayCreateAjax:function(t,e,a){var n=this;o.ajax({url:this.config.holidayURL,type:"POST",data:{date:t,description:""},success:function(t){e.attr("data-id",t.id),a.find('[name="id"]').val(t.id),a.find('[name="date"]').val(t.date)},error:function(){e.removeClass("calendar-holiday-selected"),toast(n.config.i18n.createError)}})},holidayDeleteAjax:function(t){o.ajax({url:this.config.holidayURL+"/"+t.attr("data-id"),type:"DELETE",success:function(){t.removeAttr("data-id").removeAttr("rel").removeAttr("data-tooltip")},error:function(){t.addClass("calendar-holiday-selected")}})},holidayListAjax:function(e){this.preLoader(this.$elem.find(".calendar-month"),!0,2),o.ajax({url:this.config.holidayURL,type:"GET",data:{start_date:this.getCurrentStartDate(),end_date:this.getCurrentEndDate()},success:function(t){e.doRenderHolidayList(t)},error:function(t){console.log(t)}})},doRenderWeekDaysName:function(){this.$elem.find(".calendar-month-header").empty(),this.getDateWeekDays().forEach(function(t){o(".calendar-month-header").append('<div class="calendar-month-day-name">'+t+"</div>")})},doRenderMonthYearView:function(){this.$elem.find(".calendar-month-top-month-name").text(this.getDateMonthName()+" "+this.getDateYear())},doRenderMonthDays:function(){var e=this;this.$elem.find(".calendar-month-days").empty();for(var t=this.$elem.find(".calendar-month-day-name:contains("+this.getMonthDay()[0].format("dd")+")").index(),a=0;a<t;a++)o(".calendar-month-days").append('<a class="calendar-month-day-num number"></a>');this.getMonthDay().forEach(function(t){o(".calendar-month-days").append('<a href="#" class="calendar-month-day-num number '+(t.format(e.settings.dateFormat)===this.today?"current-day":"")+'" data-date="'+t.format(e.settings.dateFormat)+'">'+t.format(e.settings.dateDayFormat)+"</a>")})},doRenderHolidayList:function(n){this.preLoader(this.$elem.find(".calendar-month"),!1,2);var t=this.$elem.find(".calendar-month-day-num");o.each(t,function(t,e){var a=o(this);n.forEach(function(t,e){a.attr("data-date")===t.date&&(a.addClass("calendar-holiday-selected").attr("data-id",t.id),""!==t.description&&a.attr("rel","tooltip").attr("data-tooltip",t.description))})})},doRenderBasicHtml:function(){this.$elem.append(this.getBasicHtml())}}).defaults,o.fn.upmonthcalendar=function(t){return this.each(function(){new a(this,t).init()})}}(jQuery,window,document);